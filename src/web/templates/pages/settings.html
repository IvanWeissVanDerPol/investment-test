{% extends "layouts/base.html" %}

{% block title %}Settings - Investment Dashboard{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12 mb-4">
        <h1 class="h3 mb-3">Settings</h1>
        <p class="text-muted">Configure your investment dashboard preferences</p>
    </div>
</div>

<div class="row">
    <!-- Navigation Tabs -->
    <div class="col-lg-3 mb-4">
        <div class="nav flex-column nav-pills" id="settings-tabs" role="tablist">
            <button class="nav-link active" id="general-tab" data-bs-toggle="pill" data-bs-target="#general">
                <i class="fas fa-cog me-2"></i>General
            </button>
            <button class="nav-link" id="portfolio-tab" data-bs-toggle="pill" data-bs-target="#portfolio">
                <i class="fas fa-briefcase me-2"></i>Portfolio
            </button>
            <button class="nav-link" id="alerts-tab" data-bs-toggle="pill" data-bs-target="#alerts">
                <i class="fas fa-bell me-2"></i>Alerts
            </button>
            <button class="nav-link" id="api-tab" data-bs-toggle="pill" data-bs-target="#api">
                <i class="fas fa-key me-2"></i>API Keys
            </button>
            <button class="nav-link" id="data-tab" data-bs-toggle="pill" data-bs-target="#data">
                <i class="fas fa-database me-2"></i>Data
            </button>
        </div>
    </div>

    <!-- Settings Content -->
    <div class="col-lg-9">
        <div class="tab-content" id="settings-content">
            <!-- General Settings -->
            <div class="tab-pane fade show active" id="general">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">General Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="general-settings">
                            <div class="mb-3">
                                <label class="form-label">Dashboard Theme</label>
                                <select class="form-select">
                                    <option value="light">Light</option>
                                    <option value="dark">Dark</option>
                                    <option value="auto">Auto (System)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Currency Format</label>
                                <select class="form-select">
                                    <option value="USD">USD ($)</option>
                                    <option value="EUR">EUR (€)</option>
                                    <option value="GBP">GBP (£)</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Auto-refresh Interval</label>
                                <select class="form-select">
                                    <option value="30">30 seconds</option>
                                    <option value="60">1 minute</option>
                                    <option value="300">5 minutes</option>
                                    <option value="600">10 minutes</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Save General Settings</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Portfolio Settings -->
            <div class="tab-pane fade" id="portfolio">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Portfolio Settings</h5>
                    </div>
                    <div class="card-body">
                        <form id="portfolio-settings">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">AI Allocation Target (%)</label>
                                    <input type="range" class="form-range" min="0" max="100" value="50" id="ai-allocation">
                                    <div class="text-center">
                                        <span id="ai-allocation-value">50%</span>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Green Investment Target (%)</label>
                                    <input type="range" class="form-range" min="0" max="100" value="30" id="green-allocation">
                                    <div class="text-center">
                                        <span id="green-allocation-value">30%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Maximum Position Size (%)</label>
                                <input type="number" class="form-control" value="15" min="1" max="50">
                                <div class="form-text">Maximum percentage of portfolio in a single stock</div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Rebalancing Frequency</label>
                                <select class="form-select">
                                    <option value="weekly">Weekly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Portfolio Settings</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Alert Settings -->
            <div class="tab-pane fade" id="alerts">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Alert Preferences</h5>
                    </div>
                    <div class="card-body">
                        <form id="alert-settings">
                            <div class="mb-3">
                                <h6>Price Alerts</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="price-alerts" checked>
                                    <label class="form-check-label" for="price-alerts">Enable price movement alerts</label>
                                </div>
                                <div class="ms-4">
                                    <label class="form-label">Alert threshold (%)</label>
                                    <input type="number" class="form-control" value="5" min="1" max="20">
                                </div>
                            </div>
                            <div class="mb-3">
                                <h6>Volume Alerts</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="volume-alerts" checked>
                                    <label class="form-check-label" for="volume-alerts">Enable volume spike alerts</label>
                                </div>
                                <div class="ms-4">
                                    <label class="form-label">Volume multiplier</label>
                                    <input type="number" class="form-control" value="2" min="1.5" max="10" step="0.5">
                                </div>
                            </div>
                            <div class="mb-3">
                                <h6>News Sentiment Alerts</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="news-alerts" checked>
                                    <label class="form-check-label" for="news-alerts">Enable news sentiment alerts</label>
                                </div>
                                <div class="ms-4">
                                    <label class="form-label">Sentiment threshold</label>
                                    <input type="number" class="form-control" value="0.7" min="0.5" max="1" step="0.1">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Alert Settings</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- API Settings -->
            <div class="tab-pane fade" id="api">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">API Configuration</h5>
                    </div>
                    <div class="card-body">
                        <form id="api-settings">
                            <div class="mb-3">
                                <label class="form-label">Alpha Vantage API Key</label>
                                <input type="password" class="form-control" value="demo-key">
                                <div class="form-text">Get your free key from alphavantage.co</div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Yahoo Finance API Key</label>
                                <input type="password" class="form-control" value="demo-key">
                                <div class="form-text">Required for real-time stock data</div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">News API Key</label>
                                <input type="password" class="form-control" value="demo-key">
                                <div class="form-text">For news sentiment analysis</div>
                            </div>
                            <button type="submit" class="btn btn-primary">Save API Settings</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Data Settings -->
            <div class="tab-pane fade" id="data">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Data Management</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <button class="btn btn-outline-primary me-2" onclick="syncData()">
                                <i class="fas fa-sync"></i> Sync Data Now
                            </button>
                            <button class="btn btn-outline-warning me-2" onclick="clearCache()">
                                <i class="fas fa-trash"></i> Clear Cache
                            </button>
                            <button class="btn btn-outline-danger" onclick="resetData()">
                                <i class="fas fa-undo"></i> Reset to Defaults
                            </button>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Data Retention Period</label>
                            <select class="form-select">
                                <option value="30">30 days</option>
                                <option value="90">90 days</option>
                                <option value="180">180 days</option>
                                <option value="365">1 year</option>
                            </select>
                        </div>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            <strong>Data Info:</strong> Last sync: {{ now|format_date }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Settings page functionality
document.addEventListener('DOMContentLoaded', function() {
    setupRangeInputs();
    setupFormHandlers();
});

function setupRangeInputs() {
    const aiRange = document.getElementById('ai-allocation');
    const greenRange = document.getElementById('green-allocation');
    
    if (aiRange) {
        aiRange.addEventListener('input', function() {
            document.getElementById('ai-allocation-value').textContent = this.value + '%';
        });
    }
    
    if (greenRange) {
        greenRange.addEventListener('input', function() {
            document.getElementById('green-allocation-value').textContent = this.value + '%';
        });
    }
}

function setupFormHandlers() {
    const forms = document.querySelectorAll('form');
    forms.forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            console.log('Saving settings for:', this.id);
            // Implement API call to save settings
            showToast('Settings saved successfully');
        });
    });
}

function syncData() {
    if (confirm('Sync all data now? This may take a few minutes.')) {
        fetch('/api/sync', { method: 'POST' })
            .then(response => response.json())
            .then(data => {
                showToast('Data sync started');
            });
    }
}

function clearCache() {
    if (confirm('Clear all cached data? This will require re-syncing.')) {
        showToast('Cache cleared');
    }
}

function resetData() {
    if (confirm('Reset all data to defaults? This action cannot be undone.')) {
        showToast('Data reset to defaults');
    }
}

function showToast(message) {
    // Simple toast notification
    const toast = document.createElement('div');
    toast.className = 'alert alert-success position-fixed';
    toast.style.top = '20px';
    toast.style.right = '20px';
    toast.style.zIndex = '9999';
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        document.body.removeChild(toast);
    }, 3000);
}
</script>
{% endblock %}"} was truncated. The file has been created successfully at: C:</Users/jandr/Documents/ivan/web/templates/pages/settings.html>